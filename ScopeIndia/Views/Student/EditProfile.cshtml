@model ScopeIndia.Models.Student
@{
    ViewData["Title"] = "Edit Profile";
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Edit Profile</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />

    <style>
        body {
            background: #f5f7fa;
        }

        .profile-wrapper {
            width: 100%;
            max-width: 1200px;
            margin: auto;
        }

        .profile-card {
            background: white;
            border-radius: 18px;
            padding: 40px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.10);
        }

        .section-title {
            font-size: 22px;
            font-weight: 700;
            color: #002b64;
            margin-bottom: 15px;
            border-left: 4px solid #002b64;
            padding-left: 10px;
        }

        .avatar-large {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 5px solid #002b64;
            box-shadow: 0 2px 10px rgba(0,0,0,0.15);
        }
    </style>
</head>

<body>

    <div class="container-fluid mt-4 mb-5">

        <!-- SUCCESS ALERT -->
        @if (TempData["Success"] != null)
        {
            <div class="alert alert-success text-center fw-bold">
                ✔ @TempData["Success"]
            </div>
        }

        <div class="profile-wrapper">
            <div class="profile-card">

                <h2 class="text-center fw-bold mb-4" style="color:#002b64;">Edit Your Profile</h2>

                <form asp-action="EditProfile" asp-controller="Student" method="post" enctype="multipart/form-data">
                    <input type="hidden" asp-for="StudentId" />

                    <!-- Avatar -->
                    <div class="text-center mb-4">
                        <img id="avatarPreview"
                             src="@(!string.IsNullOrEmpty(Model.AvatarPath) ? Model.AvatarPath : "/images/default-avatar.png")"
                             class="avatar-large" />

                        <div class="mt-3" style="max-width:250px; margin:auto;">
                            <input type="file" name="Avatar" accept="image/*"
                                   class="form-control form-control-sm"
                                   onchange="previewAvatar(event)" />
                        </div>
                    </div>

                    <!-- Personal Info -->
                    <h4 class="section-title">Personal Information</h4>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label asp-for="FirstName" class="form-label fw-semibold">First Name</label>
                            <input asp-for="FirstName" class="form-control" />
                        </div>

                        <div class="col-md-6">
                            <label asp-for="LastName" class="form-label fw-semibold">Last Name</label>
                            <input asp-for="LastName" class="form-control" />
                        </div>
                    </div>

                    <div class="mb-3">
                        <label asp-for="Email" class="form-label fw-semibold">Email</label>
                        <input asp-for="Email" class="form-control" readonly />
                    </div>

                    <div class="mb-3">
                        <label asp-for="PhoneNumber" class="form-label fw-semibold">Phone Number</label>
                        <input asp-for="PhoneNumber" class="form-control" />
                    </div>

                    <!-- Location Details -->
                    <h4 class="section-title mt-4">Location Details</h4>

                    <div class="row mb-3">

                        <!-- Country -->
                        <div class="col-md-4">
                            <label asp-for="Country" class="form-label fw-semibold">Country</label>
                            <select asp-for="Country" id="country" class="form-control">
                                <option value="">-- Select Country --</option>
                                <option>India</option>
                                <option>USA</option>
                                <option>UK</option>
                            </select>
                            <span asp-validation-for="Country" class="text-danger"></span>
                        </div>

                        <!-- State -->
                        <div class="col-md-4">
                            <label asp-for="State" class="form-label fw-semibold">State</label>
                            <select asp-for="State" id="state" class="form-control">
                                <option value="">-- Select State --</option>
                            </select>
                            <span asp-validation-for="State" class="text-danger"></span>
                        </div>

                        <!-- City -->
                        <div class="col-md-4">
                            <label asp-for="City" class="form-label fw-semibold">City</label>
                            <select asp-for="City" id="city" class="form-control">
                                <option value="">-- Select City --</option>
                            </select>
                            <span asp-validation-for="City" class="text-danger"></span>
                        </div>

                    </div>



















                    <!-- DOB -->
                    <h4 class="section-title mt-4">Other Details</h4>

                    <div class="mb-3">
                        <label asp-for="DOB" class="form-label fw-semibold">Date of Birth</label>
                        <input asp-for="DOB" type="date" class="form-control" />
                    </div>

                    <!-- Hobbies -->
                    @{
                        var selected = (Model.Hobbies ?? "")
                        .Split(',', StringSplitOptions.RemoveEmptyEntries)
                        .ToList();
                    }

                    <div class="mb-4">
                        <label class="form-label fw-semibold">Hobbies</label><br />

                        <label class="me-3">
                            <input type="checkbox" name="Hobbies" value="Reading" @(selected.Contains("Reading") ? "checked" : "") /> Reading
                        </label>

                        <label class="me-3">
                            <input type="checkbox" name="Hobbies" value="Sports" @(selected.Contains("Sports") ? "checked" : "") /> Sports
                        </label>

                        <label>
                            <input type="checkbox" name="Hobbies" value="Music" @(selected.Contains("Music") ? "checked" : "") /> Music
                        </label>
                    </div>

                    <!-- Buttons -->
                    <div class="text-center mt-4">
                        <button type="submit" class="btn btn-success px-4 fw-semibold">💾 Save Changes</button>
                        <a asp-action="Dashboard" asp-controller="Student" class="btn btn-outline-secondary px-4 ms-2">← Back</a>
                    </div>

                </form>

            </div>
        </div>

    </div>


    <!-- Dynamic Country-State-City Script -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(function () {
            $("#country").change(function () {
                var country = $(this).val();

                $("#state").empty().append('<option value="">-- Select State --</option>');
                $("#city").empty().append('<option value="">-- Select City --</option>');

                if (country) {
                    $.get("/Student/GetStates", { country: country }, function (data) {
                        $.each(data, function (i, s) {
                            $("#state").append('<option>' + s + '</option>');
                        });
                    });
                }
            });

            $("#state").change(function () {
                var state = $(this).val();

                $("#city").empty().append('<option value="">-- Select City --</option>');

                if (state) {
                    $.get("/Student/GetCities", { state: state }, function (data) {
                        $.each(data, function (i, c) {
                            $("#city").append('<option>' + c + '</option>');
                        });
                    });
                }
            });
        });

        // Avatar Preview Live
        document.querySelector('input[name="AvatarFile"]').addEventListener('change', function (event) {
            const preview = document.getElementById('avatarPreview');
            preview.src = URL.createObjectURL(event.target.files[0]);
            preview.style.display = "block";
        });
    </script>

    @section Scripts {
        <partial name="_ValidationScriptsPartial"   />
    }






   
</body>
</html>